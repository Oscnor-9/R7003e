close all;
clear all;
clc;

kP = -404.3247
kI = -2.2604e+03
kD = -0.8411

A = 1.0e+03 * [
         0    0.0010         0         0
         0   -0.4350   -0.0061    0.0091
         0         0         0    0.0010
         0    1.9034    0.0620   -0.0400
]

B = [
         0
   20.6000
         0
  -90.0000
]

C = [
     1     0     0     0
     0     0     1     0
]

D = [
     0
]


C_acc =[1 0 0 0];
C_nacc = [0 0 1 0];
T_inv=[C_acc;
     0 1 0 0;
     0 0 1 0;
     0 0 0 1];
T=inv(T_inv);
A_tilde = T_inv *A*T;
B_tilde = T_inv * B;
C_tilde_acc = C_acc * T;
C_tilde_nacc = C_nacc * T;

Ayy = A_tilde(1,1);
Ayx = A_tilde(1,2:4);
Axy = A_tilde(2:4,1);
Axx = A_tilde(2:4,2:4);

B_y = B_tilde(1,1);
B_x = B_tilde(2:4,1);

C_y = C_tilde_nacc(1,1);
C_x = C_tilde_nacc(2:end);
CC = [Ayx; C_x];


L = ( place( Axx', CC', afPoles ) )'









% M1 = 1.0e+03 * [
%    -0.4358   -0.0072    0.0091
%    -0.0011   -0.0340    0.0010
%     1.8717   -0.0165   -0.0400
% ]
% 
% M2 = [
%    20.6000
%          0
%   -90.0000
% ]
% 
% M3 = [
%      0
%      0
%      0
% ]
% 
% M4 = [
%     1.1459
%    33.9942
%    78.4584
% ]
% 
% M5 = [
%     0.7598
%     1.1459
%    31.6987
% ]
% 
% M6 = [
%      1
%      0
%      0
%      0
% ]
% 
% M7 = [
%      0     0     0
%      1     0     0
%      0     1     0
%      0     0     1
% ]
% 
% L = [
%    15.0196    0.5900
%    -2.7287   18.9345
%     0.6038   44.9804
%    22.1715  435.4379
% ]


% 
% K = [ -10.0000  -57.4908 -105.0371  -19.5009 ]


